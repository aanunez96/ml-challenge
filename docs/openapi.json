{
  "openapi": "3.0.3",
  "info": {
    "title": "ML Challenge Product API",
    "description": "RESTful API for product catalog with validation and error handling",
    "version": "1.0.0",
    "contact": {
      "name": "API Support"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3000",
      "description": "Development server"
    }
  ],
  "paths": {
    "/api/products/{id}": {
      "get": {
        "summary": "Get product by ID",
        "description": "Retrieve a single product by its unique identifier",
        "operationId": "getProduct",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "Product unique identifier",
            "schema": {
              "type": "string",
              "pattern": "^[a-z0-9_-]{6,40}$",
              "example": "premium-laptop-mx2024"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Product found successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid product ID format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": {
                    "code": "VALIDATION_ERROR",
                    "message": "ID must be at least 6 characters",
                    "details": {
                      "field": "id",
                      "input": "123",
                      "constraint": "min_length_6"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Product not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": {
                    "code": "NOT_FOUND",
                    "message": "Product with ID 'nonexistent-product' not found",
                    "details": {
                      "resource": "products",
                      "id": "nonexistent-product"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        },
        "tags": ["Products"]
      }
    },
    "/api/products": {
      "get": {
        "summary": "List products",
        "description": "Retrieve a paginated list of products with optional search",
        "operationId": "listProducts",
        "parameters": [
          {
            "name": "q",
            "in": "query",
            "required": false,
            "description": "Search query to filter products",
            "schema": {
              "type": "string",
              "example": "laptop"
            }
          },
          {
            "name": "page",
            "in": "query",
            "required": false,
            "description": "Page number for pagination",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1,
              "example": 1
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "description": "Number of items per page",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 12,
              "example": 10
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Products retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductListResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid query parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        },
        "tags": ["Products"]
      }
    }
  },
  "components": {
    "schemas": {
      "ProductResponse": {
        "type": "object",
        "required": [
          "id",
          "title",
          "description",
          "images",
          "price",
          "paymentMethods",
          "seller",
          "stock",
          "rating"
        ],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^[a-z0-9_-]{6,40}$",
            "description": "Product unique identifier",
            "example": "premium-laptop-mx2024"
          },
          "title": {
            "type": "string",
            "minLength": 1,
            "maxLength": 160,
            "description": "Product title",
            "example": "MacBook Pro 16\" M3 Max - Premium Edition"
          },
          "description": {
            "type": "string",
            "minLength": 1,
            "maxLength": 5000,
            "description": "Product detailed description",
            "example": "Experience ultimate performance with the latest MacBook Pro..."
          },
          "images": {
            "type": "array",
            "minItems": 1,
            "maxItems": 10,
            "items": {
              "type": "string",
              "format": "uri",
              "pattern": "^https://.*",
              "description": "Product image URL (HTTPS only)"
            },
            "example": [
              "https://example.com/images/macbook-pro-16-m3-max-front.jpg",
              "https://example.com/images/macbook-pro-16-m3-max-side.jpg"
            ]
          },
          "price": {
            "$ref": "#/components/schemas/Price"
          },
          "paymentMethods": {
            "type": "array",
            "minItems": 1,
            "items": {
              "$ref": "#/components/schemas/PaymentMethod"
            }
          },
          "seller": {
            "$ref": "#/components/schemas/Seller"
          },
          "stock": {
            "type": "integer",
            "minimum": 0,
            "description": "Available stock quantity",
            "example": 15
          },
          "rating": {
            "$ref": "#/components/schemas/Rating"
          },
          "flags": {
            "$ref": "#/components/schemas/ProductFlags"
          }
        },
        "example": {
          "id": "premium-laptop-mx2024",
          "title": "MacBook Pro 16\" M3 Max - Premium Edition",
          "description": "Experience ultimate performance with the latest MacBook Pro featuring M3 Max chip...",
          "images": [
            "https://example.com/images/macbook-pro-16-m3-max-front.jpg"
          ],
          "price": {
            "amount": 89999.99,
            "currency": "MXN"
          },
          "paymentMethods": [
            {
              "label": "Tarjeta de Crédito",
              "note": "12 meses sin intereses disponibles"
            }
          ],
          "seller": {
            "id": "apple-store-mx",
            "name": "Apple Store México",
            "rating": 4.9,
            "sales": 125430,
            "isOfficial": true,
            "location": "Ciudad de México, CDMX"
          },
          "stock": 15,
          "rating": {
            "average": 4.8,
            "count": 2847
          },
          "flags": {
            "full": true,
            "freeShipping": true
          }
        }
      },
      "Price": {
        "type": "object",
        "required": ["amount", "currency"],
        "properties": {
          "amount": {
            "type": "number",
            "minimum": 0,
            "multipleOf": 0.01,
            "description": "Price amount with max 2 decimal places",
            "example": 89999.99
          },
          "currency": {
            "type": "string",
            "enum": ["MXN", "USD"],
            "description": "Currency code",
            "example": "MXN"
          }
        }
      },
      "Rating": {
        "type": "object",
        "required": ["average", "count"],
        "properties": {
          "average": {
            "type": "number",
            "minimum": 0,
            "maximum": 5,
            "multipleOf": 0.1,
            "description": "Average rating (0-5 in 0.1 steps)",
            "example": 4.8
          },
          "count": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of ratings",
            "example": 2847
          }
        }
      },
      "PaymentMethod": {
        "type": "object",
        "required": ["label"],
        "properties": {
          "label": {
            "type": "string",
            "minLength": 1,
            "maxLength": 40,
            "description": "Payment method name",
            "example": "Tarjeta de Crédito"
          },
          "note": {
            "type": "string",
            "maxLength": 100,
            "description": "Additional payment method information",
            "example": "12 meses sin intereses disponibles"
          }
        }
      },
      "Seller": {
        "type": "object",
        "required": ["id", "name", "rating", "sales", "isOfficial"],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^[a-z0-9_-]{6,40}$",
            "description": "Seller unique identifier",
            "example": "apple-store-mx"
          },
          "name": {
            "type": "string",
            "minLength": 1,
            "description": "Seller name",
            "example": "Apple Store México"
          },
          "rating": {
            "type": "number",
            "minimum": 0,
            "maximum": 5,
            "description": "Seller rating (0-5)",
            "example": 4.9
          },
          "sales": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of completed sales",
            "example": 125430
          },
          "isOfficial": {
            "type": "boolean",
            "description": "Whether seller is an official store",
            "example": true
          },
          "location": {
            "type": "string",
            "description": "Seller location",
            "example": "Ciudad de México, CDMX"
          }
        }
      },
      "ProductFlags": {
        "type": "object",
        "properties": {
          "full": {
            "type": "boolean",
            "description": "Product is fully featured",
            "example": true
          },
          "freeShipping": {
            "type": "boolean",
            "description": "Free shipping available",
            "example": true
          }
        }
      },
      "ProductListResponse": {
        "type": "object",
        "required": ["items", "page", "total"],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProductResponse"
            },
            "description": "Array of products"
          },
          "page": {
            "type": "integer",
            "minimum": 1,
            "description": "Current page number",
            "example": 1
          },
          "total": {
            "type": "integer",
            "minimum": 0,
            "description": "Total number of products matching criteria",
            "example": 3
          }
        },
        "example": {
          "items": [
            {
              "id": "premium-laptop-mx2024",
              "title": "MacBook Pro 16\" M3 Max - Premium Edition",
              "price": {
                "amount": 89999.99,
                "currency": "MXN"
              }
            }
          ],
          "page": 1,
          "total": 1
        }
      },
      "ErrorResponse": {
        "type": "object",
        "required": ["error"],
        "properties": {
          "error": {
            "type": "object",
            "required": ["code", "message"],
            "properties": {
              "code": {
                "type": "string",
                "enum": [
                  "VALIDATION_ERROR",
                  "NOT_FOUND",
                  "INTERNAL_ERROR",
                  "NOT_IMPLEMENTED"
                ],
                "description": "Error classification code",
                "example": "NOT_FOUND"
              },
              "message": {
                "type": "string",
                "description": "Human-readable error message",
                "example": "Product with ID 'nonexistent-product' not found"
              },
              "details": {
                "type": "object",
                "description": "Additional error context",
                "additionalProperties": true
              }
            }
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "Products",
      "description": "Product catalog operations"
    }
  ]
}
